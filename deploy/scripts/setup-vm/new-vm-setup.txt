1 New virtual machine setup
1.0 on dev host that will create the new vm, setup port forwarding in nat.conf  so that incomingtcp section has
---begin nat.conf fragment
# following for ssh to vm with ip address 172.16.221.139 used by Ansible
50022 = 172.16.221.139:22
--end nat.conf fragment.
TODO: use ansible to update the above depending on the vm ipaddress

1.1 enable remote login via preferences/sharing/remotelogin

1.1.2 enable automatic login in users/groups, login options, Automatic login

1.1.1 run vm-setup.sh

install pm2, and set to start at startup (todo: is 'pm2 list' sufficient?)

ensure that .ssh key for git.corp.yahoo.com has no passphrase (required for pm2 deploy)

adjust vm per https://github.com/Unitech/pm2-deploy/issues/41
... BEGIN add the following to ~/guser/.bashrc  changing reasonfeed-vm as appropriate
#needed for pm2 post-deploy
export PATH=~/bin:/usr/local/bin:usr/bin:$PATH
... END add

FUSION

set vmware fusion usb compatibility to 2.0.
rename vm as appropriate
sharing name=hostDataDir folder ==DataDir
Processors: 2 processor cores
Memory: 6156 mb
network Adapter: share With my mac



TODO: parameterize following wrt VMs
1.2 setup ssh
...create ~/.ssh dir
1.5 from a develop machine. Make sure device is shutdown
1.5.0 vmrun stop ~/Documents/Virtual\ Machines.localized/OS\ X\ 10.10.vmwarevm/OS\ X\ 10.10.vmx
1.5.1 vmrun clone ~/Documents/Virtual\ Machines.localized/OS\ X\ 10.10.vmwarevm/OS\ X\ 10.10.vmx  /Volumes/startech/vm3/GuerillaVMv3.vmx full
1.5.1.1 vmrun clone /Volumes/startech/vm3/GuerillaVMv3.vmx /Volumes/startech/vm3/GuerillaVMv3-linked1.vmx linked
1.5.1.2 vmrun clone /Volumes/startech/vm3/GuerillaVMv3.vmx /Volumes/startech/vm3/GuerillaVMv3-linked2.vmx linked
1.5.1.0 brew install ssh-copy-id
1.5.1.1 ssh-copy-id -i ~/.ssh/id_rsa.pub remote-host
1.5.1.2 ssh remote-host #to verify
<as an alternative if ssh-copy-id is not available>1.5.2 cat ~/.ssh/id_rsa.pub | ssh user@remotehost 'cat >> ~/.ssh/authorized_keys' 

npm install pm2 -g
pm2 update


pm2 deploy ecosystem-worker.json dev setup
pm2 deploy ecosystem-worker.json dev